---
owner_slack: "#modernisation-platform"
title: AWS Network Firewall
last_reviewed_on: 2022-02-06
review_in: 6 months
---

# <%= current_page.data.title %>

We currently have setup in our core-network account AWS Network Firewall to monitor and control network traffic on a layer 3 level for transit gateway connection and cross account vpcs to protect reources
such as EC2 instances, along with a general AWS resources

## What is an AWS network firewall

To learnmore about AWS firewall please follow the link bellow

[AWS Firewall](https://aws.amazon.com/network-firewall/features/)

## Amending Rules

Rules can be amended by creating a pull request against the modernisation-platform repo and amending one of the following four file names from the core-network-services in the terrafrom environments folder.

- [development_rules.json](https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/development_rules.json)
- [test_rules.json](https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/test_rules.json)
- [preproduction_rules.json](https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/preproduction_rules.json)
- [production_rules.json](https://github.com/ministryofjustice/modernisation-platform/blob/main/terraform/environments/core-network-services/production_rules.json)

The rules files are broken down to environment and not account to make thing easier keep track of, to this end i have included a link to the MP cidr repo to help with forming new rules.

[CIDR Ranges](https://github.com/ministryofjustice/modernisation-platform/blob/main/cidr-allocation.md)

Rules are made up of a rule description an action which would ether be the DROP, PASS or ALERT action with would block, allow or monitor traffic based on the source ip or cidr range then a destination ip or cidr range, the port number is requird next finaily we have thr protocal used this can be ip or udp.
Thes rules are formated in json format and a text example is shown bellow.

"<Descriptive name>": {
    "action": "<DROP,PASS, Alert ",
    " source_ip ": " cidr ip>",
    "destination_ip": "<destination cidr ip>",
    "destination_port": "<port to allow but can also ne ANY>",
    "protocol": "<can be IP or UDP "
  }

  To add a rules to the repo start by pulling down the latest copy of the repo using git pull then create a new branch and simply copy and paste the above code snippet in to the appropriate Json file for the environment you are dealing with changing the details for the description and other fields in the code snippet, to their appropriate values once this is complete save and commit your change then push do a git push to push it to the repo to create a pull request for the modernisation platform team to review.

## Example

Below is an example of PR of how add rules. In this example there is 1 additional rule to be added for the network firewall.

[Example PR](https://github.com/ministryofjustice/modernisation-platform/pull/3076/files#diff-f75678f3ed0ef5e79043a3eddc8fb56c2bea2471c91f5e8421a441ecc91a0e1c)
