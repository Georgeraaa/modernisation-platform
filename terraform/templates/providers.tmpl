## This file is automatically generated based on what regions are enabled in an AWS account.

%{ for region in account_regions ~}
provider "aws" {
  region = "${region}"
  alias  = "${provider_key}-${region}"
  %{~ if assume_role }
  assume_role {
    role_arn = var.assume_role
  }
  %{~ endif ~}
}

%{ endfor ~}

module "baselines" {
  source = "github.com/ministryofjustice/modernisation-platform-terraform-baselines"
  providers = {
    aws                = aws
    %{~ for region in account_regions ~}
    aws.${region} ${substr("              ", 0, 14-length(region))}= aws.${provider_key}-${region}
    %{~ endfor ~}
  }
  root_account_id = ${root_account_id_path}
  tags            = ${tags_path}
}
